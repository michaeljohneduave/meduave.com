---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";
import { clsx } from "clsx";
import projectMetadata from "../pages/projects/_metadata.json";

type Project = (typeof projectMetadata)[number];

// Import all project logos
const logoImports = import.meta.glob<{ default: ImageMetadata }>(
  "../assets/projects/*.{svg,png}",
  {
    eager: true,
  }
);
export const projects = projectMetadata;
---

<div class="w-full">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    {
      projects
        .filter((p) => p.show)
        .map(({ name, status, slug, logo, description }) => {
          const logoPath = logo ? `../assets/projects/${logo}` : null;
          const logoImage = logoPath ? logoImports[logoPath]?.default : null;

          return (
            <a
              href={`/projects/${slug}`}
              class="block transition-all duration-200 hover:scale-[1.02]"
            >
              <div class="h-full min-h-full py-4 px-1 sm:p-4 sm:hover:bg-white sm:hover:bg-opacity-5 rounded-md">
                <div class="flex flex-col items-center text-center">
                  <div class="h-20 w-20 mb-4">
                    {logoImage && (
                      <Image
                        class="border-0 object-contain"
                        height="80"
                        width="80"
                        src={logoImage}
                        alt={`${name} logo`}
                      />
                    )}
                  </div>
                  <div class="text-2xl font-semibold mb-2">{name}</div>
                  <p class="text-sm text-gray-400 mb-2">{description}</p>
                  <span class="text-sm">
                    Status:{" "}
                    <span
                      class={clsx(
                        "font-medium",
                        status === "Legacy" && "text-slate-300",
                        status === "In Development" && "text-green-300"
                      )}
                    >
                      {status}
                    </span>
                  </span>
                </div>
              </div>
            </a>
          );
        })
    }
  </div>
</div>
